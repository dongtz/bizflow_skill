# Confirm 工作流：生成 IM 秒回确认清单

将确认点/Open Questions 转为业务方可在 IM（飞书/企微/钉钉等）中秒回的确认消息。

---

## 输入

读取 `decisions.md` 最新一轮确认点列表。若没有则从 `outputs/01_process.md` 的 Open Questions 抽取。

## 输出

产出 `outputs/03_confirm.md`（覆盖写入），同时在 `decisions.md` 追加记录。

---

## Step 1 — 生成 outputs/03_confirm.md（覆盖写入）

文件结构固定：

```markdown
# 确认清单：<主题>

> 生成时间：<日期时间>
> 基于：outputs/01_process.md Open Questions
> 状态：待确认

---

## IM 消息稿

> 以下内容可直接复制发送到飞书/企微/钉钉

已基于聊天/纪要/文档整理流程与 BRD 初稿，需要确认以下 N 点：

#1 <问题>
→ 回复：是/否
（示例：#1 是）

#2 <问题>
→ 回复：A. xxx / B. xxx / C. xxx
（示例：#2 选B）

#3 <问题>
→ 回复：填写 ≤10 字
（示例：#3 3个工作日）

...

确认后我会更新流程与 BRD 并回发 ✓

---

## 结构化确认清单

### #1 <问题>
- **回复方式**：是/否
- **若不确认的风险**：<简述>
- **依据**：<可读来源描述>
- **建议确认人**：业务 / 技术

### #2 <问题>
- **回复方式**：A/B/C
- **若不确认的风险**：<简述>
- **依据**：<可读来源描述>
- **建议确认人**：业务 / 财务

...

---

## 确认回收记录

| # | 问题摘要 | 确认结果 | 确认人 | 确认时间 |
|---|---------|---------|--------|---------|
| 1 | | （待回收） | | |
| 2 | | （待回收） | | |
| ... | | | | |
```

### IM 消息稿格式要求

- 开头一句说明背景
- 每条用 `#1` ~ `#N` 编号
- 必须可秒回：是/否、A/B/C、短填空 ≤10 字
- 给出具体回复示例（如"#2 选B""#3 3个工作日"）
- 结尾一句说明后续动作

### 结构化确认清单格式要求

每条包含：
- **回复方式**：是/否 | A/B/C | 填空 ≤10 字
- **若不确认的风险**：一句话说清不确认会怎样
- **依据**：可读来源描述（如"李四在退款讨论中提到，但王五的说法不同"；无则写"无直接证据，需业务确认"）
- **建议确认人**：业务 / 财务 / 法务 / 技术（可多选）

### 确认回收记录

预生成空表，用户回传确认结果后由 AI 填入。当用户说"#1 是 #2 选B ..."时：
1. 更新 `outputs/03_confirm.md` 中的回收记录表
2. 将确认结果同步写入 `decisions.md`

## Step 2 — decisions.md 追加记录

```markdown
## Confirm - <日期时间>
- 确认点数量：N 条
- 输出文件：outputs/03_confirm.md
- 状态：待确认
```

当用户回传确认结果后追加：

```markdown
## Confirm 回收 - <日期时间>
- 已确认：N 条
- 结果摘要：#1 是 / #2 选B / #3 3个工作日 / ...
- 下一步：生成 BRD
```

## 完成后提示（必须向用户输出）

```
---
✅ 确认清单已生成
   共 N 条确认点，已写入 outputs/03_confirm.md

👉 下一步：发送 & 回收确认
   1. 打开 outputs/03_confirm.md，复制「IM 消息稿」部分发给业务方
   2. 收到回复后告诉我结果（如"#1 是 #2 选B #3 3个工作日"）
   3. 然后说"生成 BRD"，我会生成最终文档

💡 你也可以：
   - 先调整确认清单（如"把 #3 改成选择题"）
   - 跳过确认直接说"生成 BRD"（未确认项标【待确认】）
---
```
